{"id":"../../node_modules/@iobroker/adapter-react/GenericApp.js","dependencies":[{"name":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js.map","includedInParent":true,"mtime":499162500000},{"name":"/opt/iobroker/iobroker.rssfeed/package.json","includedInParent":true,"mtime":1608154630504},{"name":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/package.json","includedInParent":true,"mtime":1608065865079},{"name":"react","loc":{"line":8,"column":44},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/react/index.js"},{"name":"./Connection","loc":{"line":10,"column":50},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/Connection.js"},{"name":"./Dialogs/Error","loc":{"line":12,"column":44},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/Dialogs/Error.js"},{"name":"@material-ui/core/Toolbar","loc":{"line":14,"column":46},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@material-ui/core/esm/Toolbar/index.js"},{"name":"@material-ui/core/Fab","loc":{"line":16,"column":42},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@material-ui/core/esm/Fab/index.js"},{"name":"@material-ui/core/Snackbar","loc":{"line":18,"column":47},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@material-ui/core/esm/Snackbar/index.js"},{"name":"@material-ui/core/IconButton","loc":{"line":20,"column":49},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@material-ui/core/esm/IconButton/index.js"},{"name":"@material-ui/icons/Save","loc":{"line":22,"column":43},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@material-ui/icons/Save.js"},{"name":"@material-ui/icons/Close","loc":{"line":24,"column":44},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@material-ui/icons/Close.js"},{"name":"./Prompt","loc":{"line":26,"column":45},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/Prompt.js"},{"name":"./Theme","loc":{"line":28,"column":44},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/Theme.js"},{"name":"./Components/Loader","loc":{"line":30,"column":45},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/Components/Loader.js"},{"name":"./Components/Router","loc":{"line":32,"column":46},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/Components/Router.js"},{"name":"./Components/Utils","loc":{"line":34,"column":44},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/Components/Utils.js"},{"name":"./i18n","loc":{"line":36,"column":43},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n.js"},{"name":"./index.css","loc":{"line":38,"column":8},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/index.css"},{"name":"./i18n/en.json","loc":{"line":165,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/en.json"},{"name":"./i18n/de.json","loc":{"line":166,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/de.json"},{"name":"./i18n/ru.json","loc":{"line":167,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/ru.json"},{"name":"./i18n/pt.json","loc":{"line":168,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/pt.json"},{"name":"./i18n/nl.json","loc":{"line":169,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/nl.json"},{"name":"./i18n/fr.json","loc":{"line":170,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/fr.json"},{"name":"./i18n/it.json","loc":{"line":171,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/it.json"},{"name":"./i18n/es.json","loc":{"line":172,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/es.json"},{"name":"./i18n/pl.json","loc":{"line":173,"column":20},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/pl.json"},{"name":"./i18n/zh-cn.json","loc":{"line":174,"column":23},"parent":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/GenericApp.js","resolved":"/opt/iobroker/iobroker.rssfeed/node_modules/@iobroker/adapter-react/i18n/zh-cn.json"}],"generated":{"js":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _Connection = _interopRequireWildcard(require(\"./Connection\"));\n\nvar _Error = _interopRequireDefault(require(\"./Dialogs/Error\"));\n\nvar _Toolbar = _interopRequireDefault(require(\"@material-ui/core/Toolbar\"));\n\nvar _Fab = _interopRequireDefault(require(\"@material-ui/core/Fab\"));\n\nvar _Snackbar = _interopRequireDefault(require(\"@material-ui/core/Snackbar\"));\n\nvar _IconButton = _interopRequireDefault(require(\"@material-ui/core/IconButton\"));\n\nvar _Save = _interopRequireDefault(require(\"@material-ui/icons/Save\"));\n\nvar _Close = _interopRequireDefault(require(\"@material-ui/icons/Close\"));\n\nvar _Prompt = _interopRequireDefault(require(\"./Prompt\"));\n\nvar _Theme = _interopRequireDefault(require(\"./Theme\"));\n\nvar _Loader = _interopRequireDefault(require(\"./Components/Loader\"));\n\nvar _Router2 = _interopRequireDefault(require(\"./Components/Router\"));\n\nvar _Utils = _interopRequireDefault(require(\"./Components/Utils\"));\n\nvar _i18n = _interopRequireDefault(require(\"./i18n\"));\n\nrequire(\"./index.css\");\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nif (!window.localStorage) {\n  window.localStorage = {\n    getItem: function getItem() {\n      return null;\n    },\n    setItem: function setItem() {\n      return null;\n    }\n  };\n}\n\nvar styles = {\n  buttonIcon: {\n    marginRight: 8\n  }\n};\n/**\r\n * @extends {Router<import('./types').GenericAppProps, import('./types').GenericAppState>}\r\n */\n\nvar GenericApp = /*#__PURE__*/function (_Router) {\n  _inherits(GenericApp, _Router);\n\n  var _super = _createSuper(GenericApp);\n\n  /**\r\n   * @param {import('./types').GenericAppProps} props\r\n   * @param {import('./types').GenericAppSettings | undefined} settings\r\n   */\n  function GenericApp(props, settings) {\n    var _this;\n\n    _classCallCheck(this, GenericApp);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"onResize\", function () {\n      _this.resizeTimer && clearTimeout(_this.resizeTimer);\n      _this.resizeTimer = setTimeout(function () {\n        _this.resizeTimer = null;\n\n        _this.setState({\n          width: GenericApp.getWidth()\n        });\n      }, 200);\n    });\n\n    (0, _Prompt[\"default\"])();\n    var query = (window.location.search || '').replace(/^\\?/, '').replace(/#.*$/, '');\n    var args = {};\n    query.trim().split('&').filter(function (t) {\n      return t.trim();\n    }).forEach(function (b) {\n      var parts = b.split('=');\n      args[parts[0]] = parts.length === 2 ? parts[1] : true;\n    }); // extract instance from URL\n\n    _this.instance = args.instance !== undefined ? parseInt(args.instance, 10) || 0 : parseInt(window.location.search.slice(1), 10) || 0; // extract adapter name from URL\n\n    var tmp = window.location.pathname.split('/');\n    _this.adapterName = settings && settings.adapterName || props.adapterName || window.adapterName || tmp[tmp.length - 2] || 'iot';\n    _this.instanceId = 'system.adapter.' + _this.adapterName + '.' + _this.instance;\n\n    var location = _Router2[\"default\"].getLocation();\n\n    location.tab = location.tab || window.localStorage.getItem(_this.adapterName + '-adapter') || '';\n\n    var themeInstance = _this.createTheme();\n\n    _this.state = {\n      selectedTab: window.localStorage.getItem(_this.adapterName + '-adapter') || '',\n      selectedTabNum: -1,\n      \"native\": {},\n      errorText: '',\n      changed: false,\n      connected: false,\n      loaded: false,\n      isConfigurationError: '',\n      toast: '',\n      theme: themeInstance,\n      themeName: _this.getThemeName(themeInstance),\n      themeType: _this.getThemeType(themeInstance),\n      bottomButtons: (settings && settings.bottomButtons) === false ? false : (props && props.bottomButtons) === false ? false : true,\n      width: GenericApp.getWidth()\n    }; // init translations\n\n    var translations = {\n      'en': require('./i18n/en.json'),\n      'de': require('./i18n/de.json'),\n      'ru': require('./i18n/ru.json'),\n      'pt': require('./i18n/pt.json'),\n      'nl': require('./i18n/nl.json'),\n      'fr': require('./i18n/fr.json'),\n      'it': require('./i18n/it.json'),\n      'es': require('./i18n/es.json'),\n      'pl': require('./i18n/pl.json'),\n      'zh-cn': require('./i18n/zh-cn.json')\n    }; // merge together\n\n    if (settings && settings.translations) {\n      Object.keys(settings.translations).forEach(function (lang) {\n        return translations[lang] = Object.assign(translations[lang], settings.translations[lang]);\n      });\n    } else if (props.translations) {\n      Object.keys(props.translations).forEach(function (lang) {\n        return translations[lang] = Object.assign(translations[lang], props.translations[lang]);\n      });\n    }\n\n    _i18n[\"default\"].setTranslations(translations);\n\n    try {\n      _this.isIFrame = window.self !== window.top;\n    } catch (e) {\n      _this.isIFrame = true;\n    }\n\n    _this.savedNative = {}; // to detect if the config changed\n\n    _this.encryptedFields = props.encryptedFields || settings && settings.encryptedFields || [];\n    _this.socket = new _Connection[\"default\"](_objectSpread(_objectSpread({}, props && props.socket || settings && settings.socket), {}, {\n      name: _this.adapterName,\n      doNotLoadAllObjects: settings && settings.doNotLoadAllObjects,\n      onProgress: function onProgress(progress) {\n        if (progress === _Connection.PROGRESS.CONNECTING) {\n          _this.setState({\n            connected: false\n          });\n        } else if (progress === _Connection.PROGRESS.READY) {\n          _this.setState({\n            connected: true\n          });\n        } else {\n          _this.setState({\n            connected: true\n          });\n        }\n      },\n      onReady: function onReady(objects, scripts) {\n        _i18n[\"default\"].setLanguage(_this.socket.systemLang);\n\n        _this.getSystemConfig().then(function (obj) {\n          _this._secret = typeof obj !== 'undefined' && obj[\"native\"] && obj[\"native\"].secret || 'Zgfr56gFe87jJOM';\n          return _this.socket.getObject(_this.instanceId);\n        }).then(function (obj) {\n          if (obj) {\n            _this.common = obj && obj.common;\n\n            _this.onPrepareLoad(obj[\"native\"]); // decode all secrets\n\n\n            _this.setState({\n              \"native\": obj[\"native\"],\n              loaded: true\n            }, function () {\n              return _this.onConnectionReady && _this.onConnectionReady();\n            });\n          } else {\n            console.warn('Cannot load instance settings');\n\n            _this.setState({\n              \"native\": {},\n              loaded: true\n            }, function () {\n              return _this.onConnectionReady && _this.onConnectionReady();\n            });\n          }\n        });\n      },\n      onError: function onError(err) {\n        console.error(err);\n\n        _this.showError(err);\n      }\n    }));\n    return _this;\n  }\n  /**\r\n   * Called immediately after a component is mounted. Setting state here will trigger re-rendering.\r\n   */\n\n\n  _createClass(GenericApp, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener('resize', this.onResize, true);\n\n      _get(_getPrototypeOf(GenericApp.prototype), \"componentDidMount\", this).call(this);\n    }\n    /**\r\n     * Called immediately before a component is destroyed.\r\n     */\n\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.onResize, true);\n\n      _get(_getPrototypeOf(GenericApp.prototype), \"componentWillUnmount\", this).call(this);\n    }\n    /**\r\n     * @private\r\n     */\n\n  }, {\n    key: \"createTheme\",\n\n    /**\r\n     * Get a theme\r\n     * @param {string} name Theme name\r\n     * @returns {import('./types').Theme}\r\n     */\n    value: function createTheme() {\n      var name = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      return (0, _Theme[\"default\"])(_Utils[\"default\"].getThemeName(name));\n    }\n    /**\r\n     * Get the theme name\r\n     * @param {import('./types').Theme} theme Theme\r\n     * @returns {string} Theme name\r\n     */\n\n  }, {\n    key: \"getThemeName\",\n    value: function getThemeName(theme) {\n      return theme.name;\n    }\n    /**\r\n     * Get the theme type\r\n     * @param {import('./types').Theme} theme Theme\r\n     * @returns {string} Theme type\r\n     */\n\n  }, {\n    key: \"getThemeType\",\n    value: function getThemeType(theme) {\n      return theme.palette.type;\n    }\n    /**\r\n     * Changes the current theme\r\n     */\n\n  }, {\n    key: \"toggleTheme\",\n    value: function toggleTheme() {\n      var themeName = this.state.themeName;\n      var newThemeName = themeName === 'dark' ? 'blue' : themeName === 'blue' ? 'colored' : themeName === 'colored' ? 'light' : themeName === 'light' ? 'dark' : 'colored';\n\n      _Utils[\"default\"].setThemeName(newThemeName);\n\n      var theme = this.createTheme(newThemeName);\n      this.setState({\n        theme: theme,\n        themeName: this.getThemeName(theme),\n        themeType: this.getThemeType(theme)\n      });\n    }\n    /**\r\n     * Gets the system configuration.\r\n     * @returns {Promise<ioBroker.OtherObject>}\r\n     */\n\n  }, {\n    key: \"getSystemConfig\",\n    value: function getSystemConfig() {\n      if (this.socket.objects && this.socket.objects['system.config']) {\n        return Promise.resolve(this.socket.objects['system.config']);\n      } else {\n        // @ts-ignore\n        return this.socket.getObject('system.config');\n      }\n    }\n    /**\r\n     * Gets called when the socket.io connection is ready.\r\n     * You can overload this function to execute own commands.\r\n     */\n\n  }, {\n    key: \"onConnectionReady\",\n    value: function onConnectionReady() {}\n    /**\r\n     * Encrypts a string.\r\n     * @param {string} value\r\n     * @returns {string}\r\n     */\n\n  }, {\n    key: \"encrypt\",\n    value: function encrypt(value) {\n      var result = '';\n\n      for (var i = 0; i < value.length; i++) {\n        result += String.fromCharCode(this._secret[i % this._secret.length].charCodeAt(0) ^ value.charCodeAt(i));\n      }\n\n      return result;\n    }\n    /**\r\n     * Decrypts a string.\r\n     * @param {string} value\r\n     * @returns {string}\r\n     */\n\n  }, {\n    key: \"decrypt\",\n    value: function decrypt(value) {\n      var result = '';\n\n      for (var i = 0; i < value.length; i++) {\n        result += String.fromCharCode(this._secret[i % this._secret.length].charCodeAt(0) ^ value.charCodeAt(i));\n      }\n\n      return result;\n    }\n    /**\r\n     * Gets called when the navigation hash changes.\r\n     * You may override this if needed.\r\n     */\n\n  }, {\n    key: \"onHashChanged\",\n    value: function onHashChanged() {\n      var location = _Router2[\"default\"].getLocation();\n\n      if (location.tab !== this.state.selectedTab) {\n        this.selectTab(location.tab);\n      }\n    }\n    /**\r\n     * Selects the given tab.\r\n     * @param {string} tab\r\n     * @param {number} [index]\r\n     */\n\n  }, {\n    key: \"selectTab\",\n    value: function selectTab(tab, index) {\n      window.localStorage[this.adapterName + '-adapter'] = tab;\n      this.setState({\n        selectedTab: tab,\n        selectedTabNum: index\n      });\n    }\n    /**\r\n     * Gets called before the settings are saved.\r\n     * You may override this if needed.\r\n     * @param {Record<string, any>} settings \r\n     */\n\n  }, {\n    key: \"onPrepareSave\",\n    value: function onPrepareSave(settings) {\n      var _this2 = this;\n\n      // here you can encode values\n      this.encryptedFields && this.encryptedFields.forEach(function (attr) {\n        if (settings[attr]) {\n          settings[attr] = _this2.encrypt(settings[attr]);\n        }\n      });\n    }\n    /**\r\n     * Gets called after the settings are loaded.\r\n     * You may override this if needed.\r\n     * @param {Record<string, any>} settings \r\n     */\n\n  }, {\n    key: \"onPrepareLoad\",\n    value: function onPrepareLoad(settings) {\n      var _this3 = this;\n\n      // here you can encode values\n      this.encryptedFields && this.encryptedFields.forEach(function (attr) {\n        if (settings[attr]) {\n          settings[attr] = _this3.decrypt(settings[attr]);\n        }\n      });\n    }\n    /**\r\n     * Gets the extendable instances.\r\n     * @returns {Promise<any[]>}\r\n     */\n\n  }, {\n    key: \"getExtendableInstances\",\n    value: function getExtendableInstances() {\n      var _this4 = this;\n\n      return new Promise(function (resolve) {\n        _this4.socket._socket.emit('getObjectView', 'system', 'instance', null, function (err, doc) {\n          if (err) {\n            resolve([]);\n          } else {\n            resolve(doc.rows.filter(function (item) {\n              return item.value.common.webExtendable;\n            }).map(function (item) {\n              return item.value;\n            }));\n          }\n        });\n      });\n    }\n    /**\r\n     * Gets the IP addresses of the given host.\r\n     * @param {string} host\r\n     */\n\n  }, {\n    key: \"getIpAddresses\",\n    value: function getIpAddresses(host) {\n      var _this5 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this5.socket._socket.emit('getHostByIp', host || _this5.common.host, function (ip, _host) {\n          var IPs4 = [{\n            name: '[IPv4] 0.0.0.0 - ' + _i18n[\"default\"].t('ra_Listen on all IPs'),\n            address: '0.0.0.0',\n            family: 'ipv4'\n          }];\n          var IPs6 = [{\n            name: '[IPv6] ::',\n            address: '::',\n            family: 'ipv6'\n          }];\n\n          if (_host) {\n            host = _host;\n\n            if (host[\"native\"].hardware && host[\"native\"].hardware.networkInterfaces) {\n              Object.keys(host[\"native\"].hardware.networkInterfaces).forEach(function (eth) {\n                return host[\"native\"].hardware.networkInterfaces[eth].forEach(function (inter) {\n                  if (inter.family !== 'IPv6') {\n                    IPs4.push({\n                      name: '[' + inter.family + '] ' + inter.address + ' - ' + eth,\n                      address: inter.address,\n                      family: 'ipv4'\n                    });\n                  } else {\n                    IPs6.push({\n                      name: '[' + inter.family + '] ' + inter.address + ' - ' + eth,\n                      address: inter.address,\n                      family: 'ipv6'\n                    });\n                  }\n                });\n              });\n            }\n\n            IPs6.forEach(function (ip) {\n              return IPs4.push(ip);\n            });\n          }\n\n          resolve(IPs4);\n        });\n      });\n    }\n    /**\r\n     * Saves the settings to the server.\r\n     * @param {boolean} isClose True if the user is closing the dialog.\r\n     */\n\n  }, {\n    key: \"onSave\",\n    value: function onSave(isClose) {\n      var _this6 = this;\n\n      var oldObj;\n\n      if (this.state.isConfigurationError) {\n        this.setState({\n          errorText: this.state.isConfigurationError\n        });\n        return;\n      }\n\n      this.socket.getObject(this.instanceId).then(function (_oldObj) {\n        oldObj = _oldObj || {};\n\n        for (var a in _this6.state[\"native\"]) {\n          if (_this6.state[\"native\"].hasOwnProperty(a)) {\n            oldObj[\"native\"][a] = _this6.state[\"native\"][a];\n          }\n        }\n\n        if (_this6.state.common) {\n          for (var b in _this6.state.common) {\n            if (_this6.state.common.hasOwnProperty(b)) {\n              oldObj.common[b] = _this6.state.common[b];\n            }\n          }\n        }\n\n        _this6.onPrepareSave(oldObj[\"native\"]);\n\n        return _this6.socket.setObject(_this6.instanceId, oldObj);\n      }).then(function () {\n        _this6.savedNative = oldObj[\"native\"];\n\n        _this6.setState({\n          changed: false\n        });\n\n        isClose && GenericApp.onClose();\n      });\n    }\n    /**\r\n     * Renders the toast.\r\n     * @returns {JSX.Element | null} The JSX element.\r\n     */\n\n  }, {\n    key: \"renderToast\",\n    value: function renderToast() {\n      var _this7 = this;\n\n      if (!this.state.toast) return null;\n      return /*#__PURE__*/_react[\"default\"].createElement(_Snackbar[\"default\"], {\n        anchorOrigin: {\n          vertical: 'bottom',\n          horizontal: 'left'\n        },\n        open: true,\n        autoHideDuration: 6000,\n        onClose: function onClose() {\n          return _this7.setState({\n            toast: ''\n          });\n        },\n        ContentProps: {\n          'aria-describedby': 'message-id'\n        },\n        message: /*#__PURE__*/_react[\"default\"].createElement(\"span\", {\n          id: \"message-id\"\n        }, this.state.toast),\n        action: [/*#__PURE__*/_react[\"default\"].createElement(_IconButton[\"default\"], {\n          key: \"close\",\n          \"aria-label\": \"Close\",\n          color: \"inherit\",\n          className: this.props.classes.close,\n          onClick: function onClick() {\n            return _this7.setState({\n              toast: ''\n            });\n          }\n        }, /*#__PURE__*/_react[\"default\"].createElement(_Close[\"default\"], null))]\n      });\n    }\n    /**\r\n     * Closes the dialog.\r\n     * @private\r\n     */\n\n  }, {\n    key: \"renderError\",\n\n    /**\r\n     * Renders the error dialog.\r\n     * @returns {JSX.Element | null} The JSX element.\r\n     */\n    value: function renderError() {\n      var _this8 = this;\n\n      if (!this.state.errorText) {\n        return null;\n      } else {\n        return /*#__PURE__*/_react[\"default\"].createElement(_Error[\"default\"], {\n          text: this.state.errorText,\n          onClose: function onClose() {\n            return _this8.setState({\n              errorText: ''\n            });\n          }\n        });\n      }\n    }\n    /**\r\n     * Checks if the configuration has changed.\r\n     * @param {Record<string, any>} [native] the new state\r\n     */\n\n  }, {\n    key: \"getIsChanged\",\n    value: function getIsChanged(_native) {\n      _native = _native || this.state[\"native\"];\n      return JSON.stringify(_native) !== JSON.stringify(this.savedNative);\n    }\n    /**\r\n     * Gets called when loading the configuration.\r\n     * @param {Record<string, any>} newNative The new configuration object.\r\n     */\n\n  }, {\n    key: \"onLoadConfig\",\n    value: function onLoadConfig(newNative) {\n      if (JSON.stringify(newNative) !== JSON.stringify(this.state[\"native\"])) {\n        this.setState({\n          \"native\": newNative,\n          changed: this.getIsChanged(newNative)\n        });\n      }\n    }\n    /**\r\n     * Sets the configuration error.\r\n     * @param {string} errorText\r\n     */\n\n  }, {\n    key: \"setConfigurationError\",\n    value: function setConfigurationError(errorText) {\n      if (this.state.isConfigurationError !== errorText) {\n        this.setState({\n          isConfigurationError: errorText\n        });\n      }\n    }\n    /**\r\n     * Renders the save and close buttons.\r\n     * @returns {JSX.Element | undefined} The JSX element.\r\n     */\n\n  }, {\n    key: \"renderSaveCloseButtons\",\n    value: function renderSaveCloseButtons() {\n      var _this9 = this;\n\n      if (!this.state.bottomButtons) {\n        return;\n      }\n\n      var narrowWidth = this.state.width === 'xs' || this.state.width === 'sm' || this.state.width === 'md';\n      var buttonStyle = {\n        borderRadius: this.state.theme.saveToolbar.button.borderRadius || 3,\n        height: this.state.theme.saveToolbar.button.height || 32\n      };\n      return /*#__PURE__*/_react[\"default\"].createElement(_Toolbar[\"default\"], {\n        position: \"absolute\",\n        style: {\n          bottom: this.isIFrame ? 38 : 0,\n          left: 0,\n          right: 0,\n          position: 'absolute',\n          background: this.state.theme.saveToolbar.background\n        }\n      }, /*#__PURE__*/_react[\"default\"].createElement(_Fab[\"default\"], {\n        variant: \"extended\",\n        \"aria-label\": \"Save\",\n        disabled: !this.state.changed,\n        onClick: function onClick() {\n          return _this9.onSave(false);\n        },\n        style: buttonStyle\n      }, /*#__PURE__*/_react[\"default\"].createElement(_Save[\"default\"], {\n        style: !narrowWidth ? styles.buttonIcon : {}\n      }), !narrowWidth && _i18n[\"default\"].t('ra_Save')), /*#__PURE__*/_react[\"default\"].createElement(_Fab[\"default\"], {\n        variant: \"extended\",\n        \"aria-label\": \"Save and close\",\n        disabled: !this.state.changed,\n        onClick: function onClick() {\n          return _this9.onSave(true);\n        },\n        style: Object.assign({}, buttonStyle, {\n          marginLeft: 10\n        })\n      }, /*#__PURE__*/_react[\"default\"].createElement(_Save[\"default\"], {\n        style: !narrowWidth ? styles.buttonIcon : {}\n      }), !narrowWidth ? _i18n[\"default\"].t('ra_Save and close') : '+', narrowWidth && /*#__PURE__*/_react[\"default\"].createElement(_Close[\"default\"], null)), /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        style: {\n          flexGrow: 1\n        }\n      }), /*#__PURE__*/_react[\"default\"].createElement(_Fab[\"default\"], {\n        variant: \"extended\",\n        \"aria-label\": \"Close\",\n        onClick: function onClick() {\n          return GenericApp.onClose();\n        },\n        style: buttonStyle\n      }, /*#__PURE__*/_react[\"default\"].createElement(_Close[\"default\"], {\n        style: !narrowWidth ? styles.buttonIcon : {}\n      }), !narrowWidth && _i18n[\"default\"].t('ra_Close')));\n    }\n    /**\r\n     * @private\r\n     * @param {Record<string, any>} obj \r\n     * @param {any} attrs \r\n     * @param {any} value \r\n     * @returns {boolean | undefined}\r\n     */\n\n  }, {\n    key: \"_updateNativeValue\",\n    value: function _updateNativeValue(obj, attrs, value) {\n      if (_typeof(attrs) !== 'object') {\n        attrs = attrs.split('.');\n      }\n\n      var attr = attrs.shift();\n\n      if (!attrs.length) {\n        if (value && _typeof(value) === 'object') {\n          if (JSON.stringify(obj[attr]) !== JSON.stringify(value)) {\n            obj[attr] = value;\n            return true;\n          }\n        } else if (obj[attr] !== value) {\n          obj[attr] = value;\n          return true;\n        } else {\n          return false;\n        }\n      } else {\n        obj[attr] = obj[attr] || {};\n\n        if (_typeof(obj[attr]) !== 'object') {\n          throw new Error('attribute ' + attr + ' is no object, but ' + _typeof(obj[attr]));\n        }\n\n        return this._updateNativeValue(obj[attr], attrs, value);\n      }\n    }\n    /**\r\n     * Update the native value\r\n     * @param {string} attr The attribute name with dots as delimiter. \r\n     * @param {any} value The new value.\r\n     * @param {(() => void)} [cb] Callback which will be called upon completion.\r\n     */\n\n  }, {\n    key: \"updateNativeValue\",\n    value: function updateNativeValue(attr, value, cb) {\n      var _native2 = JSON.parse(JSON.stringify(this.state[\"native\"]));\n\n      if (this._updateNativeValue(_native2, attr, value)) {\n        var changed = this.getIsChanged(_native2);\n        this.setState({\n          \"native\": _native2,\n          changed: changed\n        }, cb);\n      }\n    }\n    /**\r\n     * Set the error text to be shown.\r\n     * @param {string} text\r\n     */\n\n  }, {\n    key: \"showError\",\n    value: function showError(text) {\n      this.setState({\n        errorText: text\n      });\n    }\n    /**\r\n     * Sets the toast to be shown.\r\n     * @param {string} toast\r\n     */\n\n  }, {\n    key: \"showToast\",\n    value: function showToast(toast) {\n      this.setState({\n        toast: toast\n      });\n    }\n    /**\r\n     * Renders this component.\r\n     * @returns {JSX.Element} The JSX element.\r\n     */\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (!this.state.loaded) {\n        return /*#__PURE__*/_react[\"default\"].createElement(_Loader[\"default\"], {\n          theme: this.state.themeType\n        });\n      }\n\n      return /*#__PURE__*/_react[\"default\"].createElement(\"div\", {\n        className: \"App\"\n      }, this.renderError(), this.renderToast(), this.renderSaveCloseButtons());\n    }\n  }], [{\n    key: \"getWidth\",\n\n    /**\r\n     * Gets the width depending on the window inner width.\r\n     * @returns {import('./types').Width}\r\n     */\n    value: function getWidth() {\n      /**\r\n       * innerWidth |xs      sm      md      lg      xl\r\n       *            |-------|-------|-------|-------|------>\r\n       * width      |  xs   |  sm   |  md   |  lg   |  xl\r\n       */\n      var SIZES = {\n        xs: 0,\n        sm: 600,\n        md: 960,\n        lg: 1280,\n        xl: 1920\n      };\n      var width = window.innerWidth;\n      var keys = Object.keys(SIZES).reverse();\n      var widthComputed = keys.find(function (key) {\n        return width >= SIZES[key];\n      });\n      return widthComputed || 'xs';\n    }\n  }, {\n    key: \"onClose\",\n    value: function onClose() {\n      if (typeof window.parent !== 'undefined' && window.parent) {\n        try {\n          if (window.parent.$iframeDialog && typeof window.parent.$iframeDialog.close === 'function') {\n            window.parent.$iframeDialog.close();\n          } else {\n            window.parent.postMessage('close', '*');\n          }\n        } catch (e) {\n          window.parent.postMessage('close', '*');\n        }\n      }\n    }\n  }]);\n\n  return GenericApp;\n}(_Router2[\"default\"]);\n\nvar _default = GenericApp;\nexports[\"default\"] = _default;\n\n"},"sourceMaps":{"js":{"version":3,"sources":["GenericApp.js"],"names":["window","localStorage","getItem","setItem","styles","buttonIcon","marginRight","GenericApp","props","settings","resizeTimer","clearTimeout","setTimeout","setState","width","getWidth","query","location","search","replace","args","trim","split","filter","t","forEach","b","parts","length","instance","undefined","parseInt","slice","tmp","pathname","adapterName","instanceId","Router","getLocation","tab","themeInstance","createTheme","state","selectedTab","selectedTabNum","errorText","changed","connected","loaded","isConfigurationError","toast","theme","themeName","getThemeName","themeType","getThemeType","bottomButtons","translations","require","Object","keys","lang","assign","I18n","setTranslations","isIFrame","self","top","e","savedNative","encryptedFields","socket","Connection","name","doNotLoadAllObjects","onProgress","progress","PROGRESS","CONNECTING","READY","onReady","objects","scripts","setLanguage","systemLang","getSystemConfig","then","obj","_secret","secret","getObject","common","onPrepareLoad","onConnectionReady","console","warn","onError","err","error","showError","addEventListener","onResize","removeEventListener","Utils","palette","type","newThemeName","setThemeName","Promise","resolve","value","result","i","String","fromCharCode","charCodeAt","selectTab","index","attr","encrypt","decrypt","_socket","emit","doc","rows","item","webExtendable","map","host","reject","ip","_host","IPs4","address","family","IPs6","hardware","networkInterfaces","eth","inter","push","isClose","oldObj","_oldObj","a","hasOwnProperty","onPrepareSave","setObject","onClose","vertical","horizontal","classes","close","native","JSON","stringify","newNative","getIsChanged","narrowWidth","buttonStyle","borderRadius","saveToolbar","button","height","bottom","left","right","position","background","onSave","marginLeft","flexGrow","attrs","shift","Error","_updateNativeValue","cb","parse","text","renderError","renderToast","renderSaveCloseButtons","SIZES","xs","sm","md","lg","xl","innerWidth","reverse","widthComputed","find","key","parent","$iframeDialog","postMessage"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport Connection, {PROGRESS} from './Connection';\r\n\r\nimport DialogError from './Dialogs/Error';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\n\r\nimport IconSave from '@material-ui/icons/Save';\r\nimport IconClose from '@material-ui/icons/Close';\r\n\r\nimport printPrompt from './Prompt';\r\nimport theme from './Theme';\r\nimport Loader from './Components/Loader';\r\nimport Router from './Components/Router';\r\nimport Utils from './Components/Utils';\r\nimport I18n from './i18n';\r\n\r\nimport './index.css';\r\n\r\nif (!window.localStorage) {\r\n    window.localStorage = {\r\n        getItem: () => null,\r\n        setItem: () => null,\r\n    };\r\n}\r\n\r\nconst styles = {\r\n    buttonIcon: {\r\n        marginRight: 8\r\n    },\r\n};\r\n\r\n\r\n/**\r\n * @extends {Router<import('./types').GenericAppProps, import('./types').GenericAppState>}\r\n */\r\nclass GenericApp extends Router {\r\n    /**\r\n     * @param {import('./types').GenericAppProps} props\r\n     * @param {import('./types').GenericAppSettings | undefined} settings\r\n     */\r\n    constructor(props, settings) {\r\n        super(props);\r\n\r\n        printPrompt();\r\n\r\n        let query = (window.location.search || '').replace(/^\\?/, '').replace(/#.*$/, '');\r\n        let args = {};\r\n        query.trim().split('&').filter(t => t.trim()).forEach(b => {\r\n            const parts = b.split('=');\r\n            args[parts[0]] = parts.length === 2 ? parts[1] : true;\r\n        });\r\n\r\n        // extract instance from URL\r\n        this.instance = args.instance !== undefined ? parseInt(args.instance, 10) || 0 : (parseInt(window.location.search.slice(1), 10) || 0);\r\n        // extract adapter name from URL\r\n        const tmp = window.location.pathname.split('/');\r\n        this.adapterName = (settings && settings.adapterName) || props.adapterName || window.adapterName || tmp[tmp.length - 2] || 'iot';\r\n        this.instanceId  = 'system.adapter.' + this.adapterName + '.' + this.instance;\r\n\r\n        const location = Router.getLocation();\r\n        location.tab = location.tab || window.localStorage.getItem(this.adapterName + '-adapter') || '';\r\n\r\n        const themeInstance = this.createTheme();\r\n\r\n        this.state = {\r\n            selectedTab: window.localStorage.getItem(this.adapterName + '-adapter') || '',\r\n            selectedTabNum: -1,\r\n            native: {},\r\n            errorText: '',\r\n            changed: false,\r\n            connected: false,\r\n            loaded: false,\r\n            isConfigurationError: '',\r\n            toast: '',\r\n            theme:          themeInstance,\r\n            themeName:      this.getThemeName(themeInstance),\r\n            themeType:      this.getThemeType(themeInstance),\r\n            bottomButtons: (settings && settings.bottomButtons) === false ? false : ((props && props.bottomButtons) === false ? false : true),\r\n            width:          GenericApp.getWidth(),\r\n        };\r\n\r\n        // init translations\r\n        const translations = {\r\n            'en': require('./i18n/en.json'),\r\n            'de': require('./i18n/de.json'),\r\n            'ru': require('./i18n/ru.json'),\r\n            'pt': require('./i18n/pt.json'),\r\n            'nl': require('./i18n/nl.json'),\r\n            'fr': require('./i18n/fr.json'),\r\n            'it': require('./i18n/it.json'),\r\n            'es': require('./i18n/es.json'),\r\n            'pl': require('./i18n/pl.json'),\r\n            'zh-cn': require('./i18n/zh-cn.json'),\r\n        };\r\n\r\n        // merge together\r\n        if (settings && settings.translations) {\r\n            Object.keys(settings.translations).forEach(lang => translations[lang] = Object.assign(translations[lang], settings.translations[lang]));\r\n        } else if (props.translations) {\r\n            Object.keys(props.translations).forEach(lang => translations[lang] = Object.assign(translations[lang], props.translations[lang]));\r\n        }\r\n\r\n        I18n.setTranslations(translations);\r\n\r\n        try {\r\n            this.isIFrame = window.self !== window.top;\r\n        } catch (e) {\r\n            this.isIFrame = true;\r\n        }\r\n\r\n        this.savedNative = {}; // to detect if the config changed\r\n\r\n        this.encryptedFields = props.encryptedFields || (settings && settings.encryptedFields) || [];\r\n\r\n        this.socket = new Connection({\r\n            ...((props && props.socket) || (settings && settings.socket)),\r\n            name: this.adapterName,\r\n            doNotLoadAllObjects: (settings && settings.doNotLoadAllObjects),\r\n            onProgress: progress => {\r\n                if (progress === PROGRESS.CONNECTING) {\r\n                    this.setState({connected: false});\r\n                } else if (progress === PROGRESS.READY) {\r\n                    this.setState({connected: true});\r\n                } else {\r\n                    this.setState({connected: true});\r\n                }\r\n            },\r\n            onReady: (objects, scripts) => {\r\n                I18n.setLanguage(this.socket.systemLang);\r\n\r\n                this.getSystemConfig()\r\n                    .then(obj => {\r\n                        this._secret = (typeof obj !== 'undefined' && obj.native && obj.native.secret) || 'Zgfr56gFe87jJOM';\r\n                        return this.socket.getObject(this.instanceId);\r\n                    })\r\n                    .then(obj => {\r\n                        if (obj) {\r\n                            this.common = obj && obj.common;\r\n                            this.onPrepareLoad(obj.native); // decode all secrets\r\n                            this.setState({native: obj.native, loaded: true}, () => this.onConnectionReady && this.onConnectionReady());\r\n                        } else {\r\n                            console.warn('Cannot load instance settings');\r\n                            this.setState({native: {}, loaded: true}, () => this.onConnectionReady && this.onConnectionReady());\r\n                        }\r\n                    });\r\n            },\r\n            onError: err => {\r\n                console.error(err);\r\n                this.showError(err);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Called immediately after a component is mounted. Setting state here will trigger re-rendering.\r\n     */\r\n    componentDidMount() {\r\n        window.addEventListener('resize', this.onResize, true);\r\n        super.componentDidMount();\r\n    }\r\n\r\n    /**\r\n     * Called immediately before a component is destroyed.\r\n     */\r\n    componentWillUnmount() {\r\n        window.removeEventListener('resize', this.onResize, true);\r\n        super.componentWillUnmount();\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    onResize = () => {\r\n        this.resizeTimer && clearTimeout(this.resizeTimer);\r\n        this.resizeTimer = setTimeout(() => {\r\n            this.resizeTimer = null;\r\n            this.setState({width: GenericApp.getWidth()});\r\n        }, 200)\r\n    };\r\n\r\n    /**\r\n     * Gets the width depending on the window inner width.\r\n     * @returns {import('./types').Width}\r\n     */\r\n    static getWidth() {\r\n        /**\r\n         * innerWidth |xs      sm      md      lg      xl\r\n         *            |-------|-------|-------|-------|------>\r\n         * width      |  xs   |  sm   |  md   |  lg   |  xl\r\n         */\r\n\r\n        const SIZES = {\r\n            xs: 0,\r\n            sm: 600,\r\n            md: 960,\r\n            lg: 1280,\r\n            xl: 1920\r\n        };\r\n        const width = window.innerWidth;\r\n        const keys = Object.keys(SIZES).reverse();\r\n        const widthComputed = keys.find(key => width >= SIZES[key]);\r\n\r\n        return widthComputed || 'xs';\r\n    }\r\n\r\n    /**\r\n     * Get a theme\r\n     * @param {string} name Theme name\r\n     * @returns {import('./types').Theme}\r\n     */\r\n    createTheme(name = '') {\r\n        return theme(Utils.getThemeName(name));\r\n    }\r\n\r\n    /**\r\n     * Get the theme name\r\n     * @param {import('./types').Theme} theme Theme\r\n     * @returns {string} Theme name\r\n     */\r\n    getThemeName(theme) {\r\n        return theme.name;\r\n    }\r\n\r\n    /**\r\n     * Get the theme type\r\n     * @param {import('./types').Theme} theme Theme\r\n     * @returns {string} Theme type\r\n     */\r\n    getThemeType(theme) {\r\n        return theme.palette.type;\r\n    }\r\n\r\n    /**\r\n     * Changes the current theme\r\n     */\r\n    toggleTheme() {\r\n        const themeName = this.state.themeName;\r\n\r\n        const newThemeName = themeName === 'dark' ? 'blue' :\r\n            themeName === 'blue' ? 'colored' : themeName === 'colored' ? 'light' :\r\n                themeName === 'light' ? 'dark' : 'colored';\r\n\r\n        Utils.setThemeName(newThemeName);\r\n\r\n        const theme = this.createTheme(newThemeName);\r\n\r\n        this.setState({\r\n            theme: theme,\r\n            themeName: this.getThemeName(theme),\r\n            themeType: this.getThemeType(theme)\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets the system configuration.\r\n     * @returns {Promise<ioBroker.OtherObject>}\r\n     */\r\n    getSystemConfig() {\r\n        if (this.socket.objects && this.socket.objects['system.config']) {\r\n            return Promise.resolve(this.socket.objects['system.config']);\r\n        } else {\r\n            // @ts-ignore\r\n            return this.socket.getObject('system.config');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets called when the socket.io connection is ready.\r\n     * You can overload this function to execute own commands.\r\n     */\r\n    onConnectionReady() {\r\n    }\r\n\r\n    /**\r\n     * Encrypts a string.\r\n     * @param {string} value\r\n     * @returns {string}\r\n     */\r\n    encrypt(value) {\r\n        let result = '';\r\n        for (let i = 0; i < value.length; i++) {\r\n            result += String.fromCharCode(this._secret[i % this._secret.length].charCodeAt(0) ^ value.charCodeAt(i));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Decrypts a string.\r\n     * @param {string} value\r\n     * @returns {string}\r\n     */\r\n    decrypt(value) {\r\n        let result = '';\r\n        for (let i = 0; i < value.length; i++) {\r\n            result += String.fromCharCode(this._secret[i % this._secret.length].charCodeAt(0) ^ value.charCodeAt(i));\r\n        }\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Gets called when the navigation hash changes.\r\n     * You may override this if needed.\r\n     */\r\n    onHashChanged() {\r\n        const location = Router.getLocation();\r\n        if (location.tab !== this.state.selectedTab) {\r\n            this.selectTab(location.tab);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Selects the given tab.\r\n     * @param {string} tab\r\n     * @param {number} [index]\r\n     */\r\n    selectTab(tab, index) {\r\n        window.localStorage[this.adapterName + '-adapter'] = tab;\r\n        this.setState({selectedTab: tab, selectedTabNum: index})\r\n    }\r\n\r\n    /**\r\n     * Gets called before the settings are saved.\r\n     * You may override this if needed.\r\n     * @param {Record<string, any>} settings \r\n     */\r\n    onPrepareSave(settings) {\r\n        // here you can encode values\r\n        this.encryptedFields && this.encryptedFields.forEach(attr => {\r\n            if (settings[attr]) {\r\n                settings[attr] = this.encrypt(settings[attr]);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets called after the settings are loaded.\r\n     * You may override this if needed.\r\n     * @param {Record<string, any>} settings \r\n     */\r\n    onPrepareLoad(settings) {\r\n        // here you can encode values\r\n        this.encryptedFields && this.encryptedFields.forEach(attr => {\r\n            if (settings[attr]) {\r\n                settings[attr] = this.decrypt(settings[attr]);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets the extendable instances.\r\n     * @returns {Promise<any[]>}\r\n     */\r\n    getExtendableInstances() {\r\n        return new Promise(resolve => {\r\n            this.socket._socket.emit('getObjectView', 'system', 'instance', null, (err, doc) => {\r\n                if (err) {\r\n                    resolve([]);\r\n                } else {\r\n                    resolve(doc.rows.filter(item => item.value.common.webExtendable).map(item => item.value));\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Gets the IP addresses of the given host.\r\n     * @param {string} host\r\n     */\r\n    getIpAddresses(host) {\r\n        return new Promise((resolve, reject) => {\r\n            this.socket._socket.emit('getHostByIp', host || this.common.host, (ip, _host) => {\r\n                const IPs4 = [{name: '[IPv4] 0.0.0.0 - ' + I18n.t('ra_Listen on all IPs'), address: '0.0.0.0', family: 'ipv4'}];\r\n                const IPs6 = [{name: '[IPv6] ::',      address: '::',      family: 'ipv6'}];\r\n                if (_host) {\r\n                    host = _host;\r\n                    if (host.native.hardware && host.native.hardware.networkInterfaces) {\r\n                        Object.keys(host.native.hardware.networkInterfaces).forEach(eth =>\r\n                            host.native.hardware.networkInterfaces[eth].forEach(inter => {\r\n                                if (inter.family !== 'IPv6') {\r\n                                    IPs4.push({name: '[' + inter.family + '] ' + inter.address + ' - ' + eth, address: inter.address, family: 'ipv4'});\r\n                                } else {\r\n                                    IPs6.push({name: '[' + inter.family + '] ' + inter.address + ' - ' + eth, address: inter.address, family: 'ipv6'});\r\n                                }\r\n                            }));\r\n                    }\r\n                    IPs6.forEach(ip => IPs4.push(ip));\r\n                }\r\n                resolve(IPs4);\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Saves the settings to the server.\r\n     * @param {boolean} isClose True if the user is closing the dialog.\r\n     */\r\n    onSave(isClose) {\r\n        let oldObj;\r\n        if (this.state.isConfigurationError) {\r\n            this.setState({errorText: this.state.isConfigurationError});\r\n            return;\r\n        }\r\n\r\n        this.socket.getObject(this.instanceId)\r\n            .then(_oldObj => {\r\n                oldObj = _oldObj || {};\r\n\r\n                for (const a in this.state.native) {\r\n                    if (this.state.native.hasOwnProperty(a)) {\r\n                        oldObj.native[a] = this.state.native[a];\r\n                    }\r\n                }\r\n\r\n                if (this.state.common) {\r\n                    for (const b in this.state.common) {\r\n                        if (this.state.common.hasOwnProperty(b)) {\r\n                            oldObj.common[b] = this.state.common[b];\r\n                        }\r\n                    }\r\n                }\r\n\r\n                this.onPrepareSave(oldObj.native);\r\n\r\n                return this.socket.setObject(this.instanceId, oldObj);\r\n            })\r\n            .then(() => {\r\n                this.savedNative = oldObj.native;\r\n                this.setState({changed: false});\r\n                isClose && GenericApp.onClose();\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Renders the toast.\r\n     * @returns {JSX.Element | null} The JSX element.\r\n     */\r\n    renderToast() {\r\n        if (!this.state.toast) return null;\r\n        return (\r\n            <Snackbar\r\n                anchorOrigin={{\r\n                    vertical: 'bottom',\r\n                    horizontal: 'left',\r\n                }}\r\n                open={true}\r\n                autoHideDuration={6000}\r\n                onClose={() => this.setState({toast: ''})}\r\n                ContentProps={{\r\n                    'aria-describedby': 'message-id',\r\n                }}\r\n                message={<span id=\"message-id\">{this.state.toast}</span>}\r\n                action={[\r\n                    <IconButton\r\n                        key=\"close\"\r\n                        aria-label=\"Close\"\r\n                        color=\"inherit\"\r\n                        className={this.props.classes.close}\r\n                        onClick={() => this.setState({toast: ''})}\r\n                    >\r\n                        <IconClose />\r\n                    </IconButton>,\r\n                ]}\r\n            />);\r\n    }\r\n\r\n    /**\r\n     * Closes the dialog.\r\n     * @private\r\n     */\r\n    static onClose() {\r\n        if (typeof window.parent !== 'undefined' && window.parent) {\r\n            try {\r\n                if (window.parent.$iframeDialog && typeof window.parent.$iframeDialog.close === 'function') {\r\n                    window.parent.$iframeDialog.close();\r\n                } else {\r\n                    window.parent.postMessage('close', '*');\r\n                }\r\n            } catch (e) {\r\n                window.parent.postMessage('close', '*');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Renders the error dialog.\r\n     * @returns {JSX.Element | null} The JSX element.\r\n     */\r\n    renderError() {\r\n        if (!this.state.errorText) {\r\n            return null;\r\n        } else {            \r\n            return <DialogError text={this.state.errorText} onClose={() => this.setState({errorText: ''})}/>;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Checks if the configuration has changed.\r\n     * @param {Record<string, any>} [native] the new state\r\n     */\r\n    getIsChanged(native) {\r\n        native = native || this.state.native;\r\n        return JSON.stringify(native) !== JSON.stringify(this.savedNative);\r\n    }\r\n\r\n    /**\r\n     * Gets called when loading the configuration.\r\n     * @param {Record<string, any>} newNative The new configuration object.\r\n     */\r\n    onLoadConfig(newNative) {\r\n        if (JSON.stringify(newNative) !== JSON.stringify(this.state.native)) {\r\n            this.setState({native: newNative, changed: this.getIsChanged(newNative)})\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets the configuration error.\r\n     * @param {string} errorText\r\n     */\r\n    setConfigurationError(errorText) {\r\n        if (this.state.isConfigurationError !== errorText) {\r\n            this.setState({isConfigurationError: errorText});\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Renders the save and close buttons.\r\n     * @returns {JSX.Element | undefined} The JSX element.\r\n     */\r\n    renderSaveCloseButtons() {\r\n        if (!this.state.bottomButtons) {\r\n            return;\r\n        }\r\n\r\n        const narrowWidth = this.state.width === 'xs' || this.state.width === 'sm' || this.state.width === 'md';\r\n        const buttonStyle = {\r\n            borderRadius: this.state.theme.saveToolbar.button.borderRadius || 3,\r\n            height: this.state.theme.saveToolbar.button.height || 32,\r\n        };\r\n\r\n        return (\r\n            <Toolbar position=\"absolute\" style={{bottom: this.isIFrame ? 38 : 0, left: 0, right: 0, position: 'absolute', background: this.state.theme.saveToolbar.background}}>\r\n                <Fab\r\n                    variant=\"extended\"\r\n                    aria-label=\"Save\"\r\n                    disabled={!this.state.changed}\r\n                    onClick={() => this.onSave(false)}\r\n                    style={buttonStyle}\r\n                >\r\n                    <IconSave style={!narrowWidth ? styles.buttonIcon : {}}/>{!narrowWidth && I18n.t('ra_Save')}\r\n                </Fab>\r\n                <Fab\r\n                    variant=\"extended\"\r\n                    aria-label=\"Save and close\"\r\n                    disabled={!this.state.changed}\r\n                    onClick={() => this.onSave(true)}\r\n                    style={Object.assign({}, buttonStyle, {marginLeft: 10})}>\r\n                    <IconSave style={!narrowWidth ? styles.buttonIcon : {}}/>\r\n                    {!narrowWidth ? I18n.t('ra_Save and close') : '+'}\r\n                    {narrowWidth && <IconClose/>}\r\n                </Fab>\r\n                <div style={{flexGrow: 1}}/>\r\n                <Fab variant=\"extended\" aria-label=\"Close\" onClick={() => GenericApp.onClose()} style={buttonStyle}>\r\n                    <IconClose style={!narrowWidth ? styles.buttonIcon : {}}/>{!narrowWidth && I18n.t('ra_Close')}\r\n                </Fab>\r\n            </Toolbar>)\r\n    }\r\n\r\n    /**\r\n     * @private\r\n     * @param {Record<string, any>} obj \r\n     * @param {any} attrs \r\n     * @param {any} value \r\n     * @returns {boolean | undefined}\r\n     */\r\n    _updateNativeValue(obj, attrs, value) {\r\n        if (typeof attrs !== 'object') {\r\n            attrs = attrs.split('.');\r\n        }\r\n        const attr = attrs.shift();\r\n        if (!attrs.length) {\r\n            if (value && typeof value === 'object') {\r\n                if (JSON.stringify(obj[attr]) !== JSON.stringify(value)) {\r\n                    obj[attr] = value;\r\n                    return true;\r\n                }\r\n            } else if (obj[attr] !== value) {\r\n                obj[attr] = value;\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n\r\n        } else {\r\n            obj[attr] = obj[attr] || {};\r\n            if (typeof obj[attr] !== 'object') {\r\n                throw new Error('attribute ' + attr + ' is no object, but ' + typeof obj[attr]);\r\n            }\r\n            return this._updateNativeValue(obj[attr], attrs, value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update the native value\r\n     * @param {string} attr The attribute name with dots as delimiter. \r\n     * @param {any} value The new value.\r\n     * @param {(() => void)} [cb] Callback which will be called upon completion.\r\n     */\r\n    updateNativeValue(attr, value, cb) {\r\n        const native = JSON.parse(JSON.stringify(this.state.native));\r\n        if (this._updateNativeValue(native, attr, value)) {\r\n            const changed = this.getIsChanged(native);\r\n            this.setState({native, changed}, cb);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the error text to be shown.\r\n     * @param {string} text\r\n     */\r\n    showError(text) {\r\n        this.setState({errorText: text});\r\n    }\r\n\r\n    /**\r\n     * Sets the toast to be shown.\r\n     * @param {string} toast\r\n     */\r\n    showToast(toast) {\r\n        this.setState({toast});\r\n    }\r\n\r\n    /**\r\n     * Renders this component.\r\n     * @returns {JSX.Element} The JSX element.\r\n     */\r\n    render() {\r\n        if (!this.state.loaded) {\r\n            return <Loader theme={this.state.themeType}/>;\r\n        }\r\n\r\n        return <div className=\"App\">\r\n            {this.renderError()}\r\n            {this.renderToast()}\r\n            {this.renderSaveCloseButtons()}\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport default GenericApp;\r\n"],"file":"GenericApp.js"}},"error":null,"hash":"29e58fa54ec1b40b9a6f04349b763a17","cacheData":{"env":{}}}